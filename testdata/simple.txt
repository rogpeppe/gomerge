mkdir m
cd m

# initial commit -> main
cp ../c0/go.mod ../c0/x.go .
exec git init
exec git config user.email foo@example.com
exec git config user.name foo
exec git config mergetool.gomerge.cmd 'gomerge "$BASE" "$LOCAL" "$REMOTE" "$MERGED"'
exec git config mergetool.gomerge.trustExitCode true
exec git add .
exec git commit -m 'initial commit'
exec git checkout -b main

# require a -> branch1
exec git checkout -b branch1
cp ../c1/go.mod ../c1/a.go .
exec git add .
exec git commit -m 'require a'
exec git checkout main

# require b -> branch2
exec git checkout -b branch2
cp ../c2/go.mod ../c2/b.go .
exec git add .
exec git commit -m 'require b'

# merge branch1 onto main
exec git checkout main
exec git merge branch1

# merge branch2 onto main (conflict)
! exec git merge branch2
exec git mergetool -t gomerge
-- c0/go.mod --
module github.com/rogpeppe/gomerge

go 1.16
-- c0/x.go --
package main

func main() {
}
-- c1/go.mod --
module github.com/rogpeppe/gomerge

go 1.16

require "example.com/a"
-- c1/x.go --
package main

func main() {
}
-- c1/a.go --
package main

import _ "example.com/a"
-- c2/go.mod --
module github.com/rogpeppe/gomerge

go 1.16

require "example.com/b"
-- c2/b.go --
package main

import _ "example.com/b"
